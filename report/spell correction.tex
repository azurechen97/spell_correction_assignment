
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Spelling Correction}
    \author{Chen, Aoxue}
    
    
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Preparation}\label{preparation}

As the text is in category of news, we can use the Reuters corpus in
\textbf{ntlk}.

First, we extract the word frequency, bigram and other informations from
the corpus. To save time, we can use \textbf{pickle} library to save the
data into an external file.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{from} \PY{n+nn}{pandas} \PY{k}{import} \PY{n}{Series}\PY{p}{,} \PY{n}{DataFrame}
        \PY{k+kn}{import} \PY{n+nn}{math}
        \PY{k+kn}{import} \PY{n+nn}{nltk}
        \PY{k+kn}{from} \PY{n+nn}{nltk} \PY{k}{import} \PY{n}{word\PYZus{}tokenize}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{reuters}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{reuters\PYZus{}list} \PY{o}{=} \PY{n}{reuters}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{p}{)}
        \PY{n}{un\PYZus{}freq} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{FreqDist}\PY{p}{(}\PY{n}{reuters\PYZus{}list}\PY{p}{)} \PY{c+c1}{\PYZsh{} word frequency}
        \PY{n}{bigrams} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{bigrams}\PY{p}{(}\PY{n}{reuters\PYZus{}list}\PY{p}{)}
        \PY{n}{bi\PYZus{}freq} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{FreqDist}\PY{p}{(}\PY{n}{bigrams}\PY{p}{)} \PY{c+c1}{\PYZsh{} Bigram frequency}
        \PY{n}{V} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{un\PYZus{}freq}\PY{p}{)} \PY{c+c1}{\PYZsh{} vocabulary size}
        \PY{n}{N} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{reuters\PYZus{}list}\PY{p}{)} \PY{c+c1}{\PYZsh{} tokens}
\end{Verbatim}

    Save the data into dataFile:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataFile}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{fw}\PY{p}{:}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{un\PYZus{}freq}\PY{p}{,}\PY{n}{fw}\PY{p}{)}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{bi\PYZus{}freq}\PY{p}{,}\PY{n}{fw}\PY{p}{)}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{V}\PY{p}{,}\PY{n}{fw}\PY{p}{)}
            \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{N}\PY{p}{,}\PY{n}{fw}\PY{p}{)}
\end{Verbatim}

    Open a new python file for main program. Firstly open the vocabulary
file:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vocab.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{vocab\PYZus{}file}\PY{p}{:}
            \PY{n}{lines} \PY{o}{=} \PY{n}{vocab\PYZus{}file}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}
        \PY{n}{vocab} \PY{o}{=} \PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{lines}\PY{p}{]}
\end{Verbatim}

    Load the saved data from dataFile:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataFile}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{fr}\PY{p}{:}
            \PY{n}{un\PYZus{}freq} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{fr}\PY{p}{)}
            \PY{n}{bi\PYZus{}freq} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{fr}\PY{p}{)}
            \PY{n}{V} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{fr}\PY{p}{)}
            \PY{n}{N} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{fr}\PY{p}{)}
\end{Verbatim}

    Load the test data:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{testdata} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}table}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{testdata.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
        \PY{n}{n} \PY{o}{=} \PY{n}{testdata}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \section{Generate the candidate
words}\label{generate-the-candidate-words}

If we calculate each word's edit distance to every word in the
vocaburary, it will take a huge amount of time. Thus we can first
generate a set of possible words with edit distance of 1 to each
misspelled word, then check if they are legal.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{letters} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{abcdefghijklmnopqrstuvwxyz}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{letters\PYZus{}upper} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ABCDEFGHIJKLMNOPQRSTUVWXYZ}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{other} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ \PYZhy{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}
        
        \PY{k}{def} \PY{n+nf}{distance\PYZus{}1}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
            \PY{n}{total} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{word}\PY{p}{\PYZcb{}} \PY{c+c1}{\PYZsh{}Including itself}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{l} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{p}{:}\PY{n}{i}\PY{p}{]}
                \PY{n}{r} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{n}{i}\PY{p}{:}\PY{p}{]}
                \PY{n}{alphabet} \PY{o}{=} \PY{n}{letters}
                \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1} \PY{o+ow}{and} \PY{n}{i} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{p}{[}\PY{p}{:}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{r}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{+}\PY{n}{l}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{r}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}Transposition}
                    \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
                        \PY{n}{alphabet} \PY{o}{=} \PY{n}{letters}\PY{o}{+}\PY{n}{other} \PY{c+c1}{\PYZsh{} Punctuation cases}
                \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{c}\PY{o}{+}\PY{n}{r} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{alphabet}\PY{p}{]}\PY{o}{+}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{r}\PY{o}{+}\PY{n}{c} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{alphabet}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                \PY{c+c1}{\PYZsh{}Insertion}
                \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{r}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}Deletion}
                \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{c}\PY{o}{+}\PY{n}{r}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{alphabet}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}Substitution}
            \PY{n}{total} \PY{o}{=} \PY{n}{total} \PY{o}{\PYZhy{}} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}} \PY{c+c1}{\PYZsh{}Remove empty string}
            \PY{k}{return} \PY{n}{total}
\end{Verbatim}

    For words with uppercase letter, we can take the short cuts: * If the
word contains one uppercase letter that is not in the initial position,
we can try to swap the letter with the current initial letter; * If the
word only have one lowercase letter, we can consider deleting the letter
or substitude the letter with an uppercase one; * In other cases, if the
word have more than one uppercase letter, it's reasonable to insert or
substitute an uppercase letter into the misspelled word; * If none of
the mentioned operation can generate a legal word, then take the word as
in the normal situation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{k}{def} \PY{n+nf}{find\PYZus{}upper}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}Output the number and position of uppercase letters}
            \PY{n}{count} \PY{o}{=} \PY{l+m+mi}{0}
            \PY{n}{pos} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{word}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{isupper}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                    \PY{n}{count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                    \PY{n}{pos}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{)}
            \PY{k}{return} \PY{p}{[}\PY{n}{count}\PY{p}{,}\PY{n}{pos}\PY{p}{]}
        
        \PY{k}{def} \PY{n+nf}{uppercase\PYZus{}corr}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
            \PY{n}{total} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{word}\PY{p}{\PYZcb{}}
             \PY{c+c1}{\PYZsh{}UPPERCASES}
            \PY{n}{find} \PY{o}{=} \PY{n}{find\PYZus{}upper}\PY{p}{(}\PY{n}{word}\PY{p}{)}
            \PY{n}{num} \PY{o}{=} \PY{n}{find}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
            \PY{n}{ind} \PY{o}{=} \PY{n}{find}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            \PY{k}{if} \PY{n}{num} \PY{o}{==} \PY{l+m+mi}{1} \PY{o+ow}{and} \PY{n}{ind}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                \PY{k}{return} \PY{p}{\PYZob{}}\PY{n}{word}\PY{p}{\PYZcb{}}
            \PY{k}{elif} \PY{n}{num} \PY{o}{==} \PY{l+m+mi}{1} \PY{o+ow}{and} \PY{n}{ind}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:} \PY{c+c1}{\PYZsh{}One uppercase}
                \PY{n}{new\PYZus{}word} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{n}{ind}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{o}{+}\PY{n}{word}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{n}{ind}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{o}{+}\PY{n}{word}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{+}\PY{n}{word}\PY{p}{[}\PY{n}{ind}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
                \PY{k}{return} \PY{p}{\PYZob{}}\PY{n}{new\PYZus{}word}\PY{p}{,}\PY{n}{word}\PY{p}{\PYZcb{}}
            \PY{k}{elif} \PY{n}{num} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{c+c1}{\PYZsh{}e.g. INTERNAsIONAL}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                    \PY{k}{if} \PY{n}{i} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{ind}\PY{p}{:}
                        \PY{n}{l} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{p}{:}\PY{n}{i}\PY{p}{]}
                        \PY{n}{r} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{n}{i}\PY{p}{:}\PY{p}{]}
                        \PY{n}{alphabet} \PY{o}{=} \PY{n}{letters\PYZus{}upper}
                        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1} \PY{o+ow}{and} \PY{n}{i} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                            \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
                                \PY{n}{alphabet} \PY{o}{=} \PY{n}{letters\PYZus{}upper}\PY{o}{+}\PY{n}{other} \PY{c+c1}{\PYZsh{} Punctuation cases}
                        \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{r}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}Deletion}
                        \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{c}\PY{o}{+}\PY{n}{r}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{alphabet}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}Substitution}
                        \PY{k}{break}
                \PY{k}{return} \PY{n}{total}
            \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}e.g. INTERVNTION ltGR}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                    \PY{n}{l} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{p}{:}\PY{n}{i}\PY{p}{]}
                    \PY{n}{r} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{n}{i}\PY{p}{:}\PY{p}{]}
                    \PY{n}{alphabet} \PY{o}{=} \PY{n}{letters\PYZus{}upper}
                    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1} \PY{o+ow}{and} \PY{n}{i} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                        \PY{c+c1}{\PYZsh{}total.update(set([l[:i\PYZhy{}1]+r[0]+l[i\PYZhy{}1]+r[1:]])) \PYZsh{}Transposition}
                        \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
                            \PY{n}{alphabet} \PY{o}{=} \PY{n}{letters\PYZus{}upper}\PY{o}{+}\PY{n}{other} \PY{c+c1}{\PYZsh{} Punctuation cases}
                    \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{c}\PY{o}{+}\PY{n}{r} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{alphabet}\PY{p}{]}\PY{o}{+}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{r}\PY{o}{+}\PY{n}{c} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{alphabet}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                    \PY{c+c1}{\PYZsh{}Insertion}
                    \PY{c+c1}{\PYZsh{}total.update(set([l+r[1:]])) \PYZsh{}Deletion}
                    \PY{n}{total}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{o}{+}\PY{n}{c}\PY{o}{+}\PY{n}{r}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{alphabet}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}Substitution}
                \PY{k}{return} \PY{n}{total}
            \PY{k}{return} \PY{n}{total}
\end{Verbatim}

    If still no legal word is generated, we must consider the situation that
the edit distance is more than 1.

When the edit distance is 2, we have:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k}{def} \PY{n+nf}{distance\PYZus{}2}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
             \PY{k}{return} \PY{n+nb}{set}\PY{p}{(}\PY{n}{d2} \PY{k}{for} \PY{n}{d1} \PY{o+ow}{in} \PY{n}{distance\PYZus{}1}\PY{p}{(}\PY{n}{word}\PY{p}{)} \PY{k}{for} \PY{n}{d2} \PY{o+ow}{in} \PY{n}{distance\PYZus{}1}\PY{p}{(}\PY{n}{d1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    However, it's easy to find the lack of efficiency in this method.
Observing the testing text, we find that the situation where edit
distance is more than 1 are mostly just swapped two of the letters in
the word. So we can use the function below instead:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{def} \PY{n+nf}{non\PYZus{}distance\PYZus{}1}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}Swap}
             \PY{n}{total} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                     \PY{k}{if} \PY{n}{word}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{!=} \PY{n}{word}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{:}
                         \PY{n}{new\PYZus{}word} \PY{o}{=} \PY{n}{word}\PY{p}{[}\PY{p}{:}\PY{n}{i}\PY{p}{]}\PY{o}{+}\PY{n}{word}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{+}\PY{n}{word}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{n}{j}\PY{p}{]}\PY{o}{+}\PY{n}{word}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{+}\PY{n}{word}\PY{p}{[}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
                         \PY{n}{total}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{new\PYZus{}word}\PY{p}{)}
             \PY{k}{return} \PY{n}{total}
\end{Verbatim}

    \section{Calculate the probability}\label{calculate-the-probability}

We use the frequency of unigrams and bigrams to approximately calculate
the emerging probability of the next word, to choose a word most likely
to appear.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k}{def} \PY{n+nf}{log\PYZus{}smoothed\PYZus{}prob}\PY{p}{(}\PY{n}{pre}\PY{p}{,}\PY{n+nb}{next}\PY{p}{)}\PY{p}{:}
             \PY{n}{prob} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{p}{(}\PY{n}{bi\PYZus{}freq}\PY{p}{[}\PY{p}{(}\PY{n}{pre}\PY{p}{,}\PY{n+nb}{next}\PY{p}{)}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{math}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{p}{(}\PY{n}{un\PYZus{}freq}\PY{p}{[}\PY{n}{pre}\PY{p}{]}\PY{o}{+}\PY{n}{V}\PY{p}{)}\PY{p}{)}
             \PY{k}{return} \PY{n}{prob}
\end{Verbatim}

    To prevent underflow, we take the logarithm of the probabilities. In
addition, use Laplace Smothing to roughly handle the zeros.

    \section{Correction: non-word}\label{correction-non-word}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{k}{def} \PY{n+nf}{correction}\PY{p}{(}\PY{n}{pre}\PY{p}{,}\PY{n}{word}\PY{p}{,}\PY{n}{vocab}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}take the previous word as parameter as well}
             \PY{n}{prob\PYZus{}dict} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}
             \PY{n}{find} \PY{o}{=} \PY{n}{find\PYZus{}upper}\PY{p}{(}\PY{n}{word}\PY{p}{)} \PY{c+c1}{\PYZsh{} find uppercase}
             \PY{n}{num} \PY{o}{=} \PY{n}{find}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{k}{if} \PY{n}{num} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:} \PY{c+c1}{\PYZsh{}with uppercase}
                 \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{uppercase\PYZus{}corr}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
                     \PY{k}{if} \PY{n}{y} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                         \PY{n}{prob\PYZus{}dict}\PY{p}{[}\PY{n}{y}\PY{p}{]}\PY{o}{=}\PY{n}{log\PYZus{}smoothed\PYZus{}prob}\PY{p}{(}\PY{n}{pre}\PY{p}{,}\PY{n}{y}\PY{p}{)}
             \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{distance\PYZus{}1}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}normal situation}
                 \PY{k}{if} \PY{n}{y} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                     \PY{n}{prob\PYZus{}dict}\PY{p}{[}\PY{n}{y}\PY{p}{]}\PY{o}{=}\PY{n}{log\PYZus{}smoothed\PYZus{}prob}\PY{p}{(}\PY{n}{pre}\PY{p}{,}\PY{n}{y}\PY{p}{)}
             \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{non\PYZus{}distance\PYZus{}1}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}swapping situation}
                     \PY{k}{if} \PY{n}{y} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                         \PY{n}{prob\PYZus{}dict}\PY{p}{[}\PY{n}{y}\PY{p}{]}\PY{o}{=}\PY{n}{log\PYZus{}smoothed\PYZus{}prob}\PY{p}{(}\PY{n}{pre}\PY{p}{,}\PY{n}{y}\PY{p}{)}
             \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{prob\PYZus{}dict}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{k}{return} \PY{n}{word} \PY{c+c1}{\PYZsh{}if still no candidates generated, give up}
             \PY{k}{else}\PY{p}{:}
                 \PY{k}{return} \PY{n+nb}{max}\PY{p}{(}\PY{n}{prob\PYZus{}dict}\PY{p}{,}\PY{n}{key}\PY{o}{=}\PY{n}{prob\PYZus{}dict}\PY{o}{.}\PY{n}{get}\PY{p}{)}
                 \PY{c+c1}{\PYZsh{}output the one with greatest probability}
\end{Verbatim}

    Now we can use the functions to correct the words!

Meanwhile, record the wrong words we can't detect at the moment for
further investigation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{exist\PYZus{}real\PYZus{}word\PYZus{}errors} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}
         \PY{n}{result} \PY{o}{=} \PY{n}{testdata}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{n}\PY{p}{)}\PY{p}{:}
             \PY{n}{non\PYZus{}word\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{sentence} \PY{o}{=} \PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{testdata}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
             \PY{k}{for} \PY{n}{p}\PY{p}{,} \PY{n}{word} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{non\PYZus{}word\PYZus{}count} \PY{o}{==} \PY{n}{testdata}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{}no need to loop when the number is enough}
                    \PY{k}{break}
                 \PY{k}{if} \PY{n}{word} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                     \PY{n}{non\PYZus{}word\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{n}{correct\PYZus{}word} \PY{o}{=} \PY{n}{correction}\PY{p}{(}\PY{n}{sentence}\PY{p}{[}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{word}\PY{p}{,}\PY{n}{vocab}\PY{p}{)}
                     \PY{k}{if} \PY{n}{i}\PY{o}{\PYZlt{}}\PY{l+m+mi}{20}\PY{p}{:} \PY{c+c1}{\PYZsh{}only print the head}
                         \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{word}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{correct\PYZus{}word}\PY{p}{)}
                     \PY{n}{result}\PY{o}{.}\PY{n}{iat}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{result}\PY{o}{.}\PY{n}{iat}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{word}\PY{p}{,}\PY{n}{correct\PYZus{}word}\PY{p}{)}
             \PY{k}{if} \PY{n}{non\PYZus{}word\PYZus{}count} \PY{o}{!=} \PY{n}{testdata}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{:}
                 \PY{n}{exist\PYZus{}real\PYZus{}word\PYZus{}errors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{c+c1}{\PYZsh{}real word error positions}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1 protectionst protectionist
2 Tkyo Tokyo
3 retaiation retaliation
4 tases taxes
5 busines business
7 Taawin Taiwan
8 seriousnyss seriousness
9 aganst against
10 bililon billion
11 sewll swell
12 importsi imports
13 Sheem Sheen
14 wsohe whose
15 Koreva Korea
16 Japn Japan
17 semicondctors semiconductors
18 advantagne advantage
19 Lawrenc Lawrence

    \end{Verbatim}

    We get the position with read word errors:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{exist\PYZus{}real\PYZus{}word\PYZus{}errors}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[5, 19, 47, 54, 64, 118, 123, 138, 153, 157, 170, 177, 265, 267, 294, 356, 391, 410, 435, 471, 493, 497, 534, 538, 553, 619, 620, 635, 681, 684, 768, 783, 801, 813, 819, 843, 860, 869, 875, 901, 911, 931, 932, 945, 954, 955, 968, 979, 987]

    \end{Verbatim}

    \section{Correction: real-word}\label{correction-real-word}

We first instruct a function to generate candidate sentences:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{k}{def} \PY{n+nf}{generate\PYZus{}candidates}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:}
             \PY{n}{candidates} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{p}{[}\PY{n}{sentence}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{}contains itself}
             \PY{k}{for} \PY{n}{p}\PY{p}{,}\PY{n}{word} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{word}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{letters}\PY{o}{+}\PY{n}{letters\PYZus{}upper}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{}let go of the one with punctuations at initial}
                     \PY{k}{continue}
                 \PY{k}{elif} \PY{n}{word}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o+ow}{in} \PY{n}{letters\PYZus{}upper}\PY{p}{:} \PY{c+c1}{\PYZsh{} uppercase initial}
                     \PY{k}{for} \PY{n}{replace} \PY{o+ow}{in} \PY{n}{distance\PYZus{}1}\PY{p}{(}\PY{n}{word}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{replace}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:} \PY{c+c1}{\PYZsh{} one letter word}
                             \PY{n}{replace} \PY{o}{=} \PY{n}{replace}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)}
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{replace} \PY{o}{=} \PY{n}{replace}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)}\PY{o}{+}\PY{n}{replace}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
                         \PY{k}{if} \PY{n}{replace} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                             \PY{n}{candidate} \PY{o}{=} \PY{n}{sentence}\PY{p}{[}\PY{p}{:}\PY{n}{p}\PY{p}{]}\PY{o}{+}\PY{p}{[}\PY{n}{replace}\PY{p}{]}\PY{o}{+}\PY{n}{sentence}\PY{p}{[}\PY{n}{p}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
                             \PY{k}{if} \PY{n}{candidate} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{candidates}\PY{p}{:} \PY{c+c1}{\PYZsh{} avoid repitition}
                                 \PY{n}{candidates}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{candidate}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}normal}
                     \PY{k}{for} \PY{n}{replace} \PY{o+ow}{in} \PY{n}{distance\PYZus{}1}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{replace} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                             \PY{n}{candidate} \PY{o}{=} \PY{n}{sentence}\PY{p}{[}\PY{p}{:}\PY{n}{p}\PY{p}{]}\PY{o}{+}\PY{p}{[}\PY{n}{replace}\PY{p}{]}\PY{o}{+}\PY{n}{sentence}\PY{p}{[}\PY{n}{p}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
                             \PY{k}{if} \PY{n}{candidate} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{candidates}\PY{p}{:}
                                 \PY{n}{candidates}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{candidate}\PY{p}{)}
             \PY{k}{return} \PY{n}{candidates}
\end{Verbatim}

    Calculate the approximate probability of each possible sentences:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{k}{def} \PY{n+nf}{sentence\PYZus{}prob}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:}
             \PY{n}{log\PYZus{}prob} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{k}{for} \PY{n}{p}\PY{p}{,}\PY{n}{word} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{p} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                     \PY{n}{log\PYZus{}prob} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{un\PYZus{}freq}\PY{p}{[}\PY{n}{word}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{math}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{N}\PY{o}{+}\PY{n}{V}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{pre} \PY{o}{=} \PY{n}{sentence}\PY{p}{[}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
                     \PY{n}{new\PYZus{}prob} \PY{o}{=} \PY{n}{log\PYZus{}smoothed\PYZus{}prob}\PY{p}{(}\PY{n}{pre}\PY{p}{,}\PY{n}{word}\PY{p}{)}
                     \PY{n}{log\PYZus{}prob} \PY{o}{=} \PY{n}{log\PYZus{}prob} \PY{o}{+} \PY{n}{new\PYZus{}prob}
             \PY{k}{return} \PY{n}{log\PYZus{}prob}
\end{Verbatim}

    Selecting the most proper sentence in the candidates:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{k}{def} \PY{n+nf}{real\PYZus{}word\PYZus{}correction}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:}
             \PY{n}{max\PYZus{}prob} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{10000}
             \PY{n}{best\PYZus{}candidate} \PY{o}{=} \PY{n}{sentence}
             \PY{k}{for} \PY{n}{candidate} \PY{o+ow}{in} \PY{n}{generate\PYZus{}candidates}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:}
                 \PY{n}{prob} \PY{o}{=} \PY{n}{sentence\PYZus{}prob}\PY{p}{(}\PY{n}{candidate}\PY{p}{)}
                 \PY{k}{if} \PY{n}{prob} \PY{o}{\PYZgt{}} \PY{n}{max\PYZus{}prob}\PY{p}{:}
                     \PY{n}{max\PYZus{}prob} \PY{o}{=} \PY{n}{prob}
                     \PY{n}{best\PYZus{}candidate} \PY{o}{=} \PY{n}{candidate}
             \PY{k}{return} \PY{n}{best\PYZus{}candidate}
\end{Verbatim}

    Main program:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{exist\PYZus{}real\PYZus{}word\PYZus{}errors}\PY{p}{:}
             \PY{n}{sentence} \PY{o}{=} \PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{result}\PY{o}{.}\PY{n}{iat}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{correct\PYZus{}sentence} \PY{o}{=} \PY{n}{real\PYZus{}word\PYZus{}correction}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}
             \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{sentence}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{!=} \PY{n}{correct\PYZus{}sentence}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{:}
                     \PY{n}{word} \PY{o}{=} \PY{n}{sentence}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                     \PY{n}{correct\PYZus{}word} \PY{o}{=} \PY{n}{correct\PYZus{}sentence}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                     \PY{n}{result}\PY{o}{.}\PY{n}{iat}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{result}\PY{o}{.}\PY{n}{iat}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{word}\PY{p}{,}\PY{n}{correct\PYZus{}word}\PY{p}{)}
                     \PY{k}{break}
             \PY{k}{if} \PY{n}{i}\PY{o}{\PYZlt{}}\PY{l+m+mi}{300}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{word}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{correct\PYZus{}word}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
6 pace place
20 whoe whole
48 alter after
55 taking making
65 trade traded
119 so to
124 mouth month
139 latter later
154 boots boost
158 rule ruled
171 trades trade
178 sill still
266 consume consumer
268 markets market
295 stacks stocks

    \end{Verbatim}

    Write the corrected sentences into result.txt:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{result.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{result}\PY{o}{.}\PY{n}{values}\PY{p}{,}\PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{delimiter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{p}{)}
\end{Verbatim}

    \section{Evaluation}\label{evaluation}

Use \textbf{eval.py} to calculate the accuracy:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{k+kn}{import} \PY{n+nn}{nltk}
         \PY{n}{anspath}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./ans.txt}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{resultpath}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./result.txt}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{ansfile}\PY{o}{=}\PY{n+nb}{open}\PY{p}{(}\PY{n}{anspath}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{resultfile}\PY{o}{=}\PY{n+nb}{open}\PY{p}{(}\PY{n}{resultpath}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{count}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{:}
             \PY{n}{ansline}\PY{o}{=}\PY{n}{ansfile}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{n}{ansset}\PY{o}{=}\PY{n+nb}{set}\PY{p}{(}\PY{n}{nltk}\PY{o}{.}\PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{ansline}\PY{p}{)}\PY{p}{)}
             \PY{n}{resultline}\PY{o}{=}\PY{n}{resultfile}\PY{o}{.}\PY{n}{readline}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{n}{resultset}\PY{o}{=}\PY{n+nb}{set}\PY{p}{(}\PY{n}{nltk}\PY{o}{.}\PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{resultline}\PY{p}{)}\PY{p}{)}
             \PY{k}{if} \PY{n}{ansset}\PY{o}{==}\PY{n}{resultset}\PY{p}{:}
                 \PY{n}{count}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy is : }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{count}\PY{o}{*}\PY{l+m+mf}{1.00}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy is : 96.80\%

    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
